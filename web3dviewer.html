<!DOCTYPE html>

<html> 
<head> 
  <meta http-equiv='content-type' content='text/html; charset=UTF-8' />
  <title> 3DViewer demo </title> 
  <meta chatset='utf-8'>

  <link type='text/css' rel='stylesheet' href='css/web3dviewer.css'/>

  <!-- Load JQuery because everything needs JQuery -->
  <script type='text/javascript' src='js/jquery.min.js'></script>
  <!-- Three.js framework -->
  <script type='text/javascript' src='js/three.min.js'></script> 
  <!-- Camera controls -->
  <script type='text/javascript' src='js/OrbitControls.js'></script> 
  <script type='text/javascript' src='js/TrackballControls.js'></script> 
  <!-- GUI controls -->
  <script type='text/javascript' src='js/DAT.GUI.min.js'></script>
  <!-- LMBViewer application -->
  <script type='text/javascript' src='js/ThreeJSViewer.js'></script> 
  <!-- Screenshot tool -->
  <script type='text/javascript' src='js/canvas2image.js'></script> 
  <script type='text/javascript' src='js/base64.js'></script>

  <!-- Initialize the application -->
  <script type='text/javascript'>
    $(document).ready(function() {
      // Create LMBViewer instance on the target
      var lmbv = new LMBViewer( $('#LMBViewer') );
      // Run LMBViewer instance
      lmbv.run();
      // Create and insert dat.GUI for LMBViewer
      LMBViewerGUI(lmbv);

      // Set up intrinsic camera parameters
      /*lmbv.SetCameraIntrinsics( { fx: 2000.0, fy: 2000.0,
                                  cx: 670, cy: 446.5,
                                  width: 1340.0, height: 893.0 } );*/
      lmbv.SetCameraIntrinsics( { fx: 525.0, fy: 525.0,
                                  cx: 319.5, cy: 239.5,
                                  width: 640.0, height: 480.0 } );

      /// USAGE EXAMPLE:

      // Example: Display test triangle
      //lmbv.DisplayTestTriangle();

      // Example: Callback to rotate the point cloud after its creation
      var testCb = function() {
        var test_matrix = new THREE.Matrix4();
        test_matrix.makeRotationFromEuler( new THREE.Euler(-0.4, 0, 0, 'XYZ') );
        var PCL_object = lmbv.getObjectByName('testName');
        PCL_object.applyMatrix(test_matrix);
      };
      // Example: Load RGB+D data and display as point cloud
      lmbv.DisplayPointCloud( { //depthImage: './examples/couch_depth_0025_converted.png',
                                //colorImage: './examples/couch_image_0025_resized.png',
                                depthImage: './examples/depth_0000_converted.png',
                                colorImage: './examples/color_0000.png',
                                objectName: 'testName',
                                sampling_spacing: 1,
                                depthDataFormat: 'UInt16',
                                pointSize: 1,
                                callback: testCb} );
      // Example: Display camera pose
      // ... turned 180Â° around the Y axis ...
      var R = new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0,Math.PI,0,'XYZ'));
      // ... and translated 200 units in positive Z direction
      var t = new THREE.Vector3(0,0,200);
      lmbv.DisplayCameraPose( { rotation: R, translation: t });
    });
  </script>
</head> 
<body> 


  <!-- Target for the LMBViewer instance to inject its canvas element -->
  <div id='LMBViewer' style='width: 100%; min-height:100%; height: 100%;'>
  </div>

</body> 
</html>

